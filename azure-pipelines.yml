strategy:
  matrix:
    linux:
      imageName: 'ubuntu-latest'
    mac:
      imageName: 'macos-latest'
    windows:
      imageName: 'vs2017-win2016'

trigger:
- master

pool:
  vmImage: $(imageName)

steps:
- bash: etc/build/install-minion.sh
  displayName: "Install Minion"
- bash: PATH=$HOME/.local/bin:$PATH BUILD_TESTS=true make
  displayName: "Build Conjure"
- bash: PATH=$HOME/.local/bin:$PATH .stack-work/*/*/*/*/*/conjure-testing --limit-time 10 --hide-successes
  displayName: "Test"
