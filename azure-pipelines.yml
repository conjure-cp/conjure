strategy:
  matrix:
    linux:
      imageName: 'ubuntu-latest'
    mac:
      imageName: 'macos-latest'
    windows:
      imageName: 'vs2017-win2016'

trigger:
- master

pool:
  vmImage: $(imageName)

steps:
- displayName: 'Building'
  bash: |
    export PATH=$HOME/.local/bin:$PATH
    BUILD_TESTS=true time make
- displayName: 'Testing'
  bash: |
    export PATH=$HOME/.local/bin:$PATH
    .stack-work/*/*/*/*/*/conjure-testing --limit-time 10 --hide-successes
